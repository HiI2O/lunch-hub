# ユビキタス言語 (Ubiquitous Language)

> このドキュメントは、Lunch-Hub システムにおいて開発者とドメインエキスパート（業務担当者）が共通で使用する用語を定義します。
> DDDでは、コード内のクラス名・メソッド名もこの用語に従って命名します。

---

## コアコンセプト

### 予約 (Reservation)
お弁当を注文するための予約。特定の日付に対して作成され、支払い方法を含む。

### 注文 (Order)
係の人がお弁当屋さんに実際に発注する単位。複数の予約をまとめたもの。

---

## ユーザーエンティティ

### ユーザー (User)
システムにログインして弁当予約を行う社内メンバー。

### 一般ユーザー (GENERAL_USER)
社内メンバーで、自分のお弁当を予約できるユーザー。

### 係 (STAFF)
お弁当の注文を取りまとめ、お弁当屋さんに発注する担当者。係自身も弁当予約・チケット購入が可能。

### 管理者 (ADMINISTRATOR)
システム全体を管理する権限を持つユーザー。

### ゲスト (Guest)
社内メンバー以外の訪問者。係が代理で予約を作成する。システムにログインしない。

---

## ユーザーステータス

### 招待中 (INVITED)
招待メールが送信されたが、まだアクティベーションが完了していない状態。

### 有効 (ACTIVE)
アクティベーションが完了し、システムにログイン可能な状態。

### 無効 (DEACTIVATED)
管理者によってアクセスが無効化された状態。ログインできない。

---

## 認証・認可

### 招待 (Invitation)
管理者が新しいユーザーをシステムに招待する行為。招待されたユーザーには招待メールが送信される。

### 招待トークン (Invitation Token)
ユーザー招待時に生成される一意の文字列。有効期限は48時間。

### アクティベーション (Activation)
招待されたユーザーが初回パスワードを設定し、アカウントを有効化する行為。

### セルフサインアップ (Self Sign-up)
ユーザーが自らメールアドレスと社員用共通PIN（Company PIN）を入力してアカウント作成を申請すること。

### 社員用共通PIN (Company PIN)
社員であることを証明するための共有パスコード。セルフサインアップ時に使用。環境変数で設定される。


### 認証 (Authentication)
ユーザーが自分が誰であるかを証明するプロセス。メールアドレスとパスワードを使用する。

### ログイン (Login)
認証情報を使用してシステムにアクセスする行為。成功するとセッションが確立される。

### ログアウト (Logout)
確立されたセッションを終了する行為。

### セッション (Session)
ログイン後のユーザーの認証状態を表す。アクセストークンとリフレッシュトークンで管理される。

### アクセストークン (Access Token)
APIリクエストの認証に使用される短期間有効なトークン(JWT)。有効期限は15分。

### リフレッシュトークン (Refresh Token)
アクセストークンを更新するための長期間有効なトークン。有効期限は7日。

### パスワードリセット (Password Reset)
パスワードを忘れた場合に、メールアドレスを使用してパスワードを再設定する行為。

### リセットトークン (Reset Token)
パスワードリセット時に生成される一意の文字列。有効期限は1時間。

### 認可 (Authorization)
認証されたユーザーが特定のリソースやアクションにアクセスする権限があるかを判断するプロセス。

---

## 支払い関連

### 支払い方法 (Payment Method)
予約時に選択する支払い手段。現金払いまたはチケット払い。

### 現金払い (Cash Payment)
当日現金で支払う方法。

### チケット払い (Ticket Payment)
事前購入したチケットで支払う方法。

### チケット (Ticket)
事前に購入する10枚綴りの食事券。

### チケット購入予約 (Ticket Purchase Reservation)
チケットを購入する予約。お弁当屋さんに事前に伝える必要がある。

---

## 時間関連

### 予約期間 (Reservation Period)
予約可能な期間。現在から翌月末まで。

### 注文締め切り時刻 (Order Deadline)
当日の9:30。この時刻を過ぎると予約の変更・キャンセルができない。

---

## 用語の使い分け

### 予約 vs 注文
- **予約 (Reservation)**: ユーザー視点。個人がお弁当を食べたいという意思表示
- **注文 (Order)**: 係視点。お弁当屋さんに実際に発注する単位（複数の予約をまとめたもの）

### ゲスト vs ユーザー
- **ゲスト (Guest)**: システムにログインしない訪問者
- **ユーザー (User)**: システムにログインできる社内メンバー

### キャンセル vs 削除
- **キャンセル (Cancel)**: 予約やチケット購入を取り消すこと（履歴として残る）
- **削除 (Delete)**: データを完全に削除すること（基本的に使用しない）

### 招待 vs サインアップ
- **招待 (Invitation)**: 管理者が既存ユーザーを招待する方法
- **セルフサインアップ (Self Sign-up)**: ユーザーが自ら社員用PINを使って登録する方法

---

## 補足説明

このユビキタス言語は、プロジェクトの進行に伴って更新・拡張されます。
新しい概念が発見された場合や、用語の定義が曖昧な場合は、このドキュメントを更新してチーム全体で共有します。

詳細な属性、ビジネスルール、プロセス、不変条件については、以下のドキュメントを参照してください:
- [要件定義書](../01-requirements.md) - 機能要件とビジネスルール
- [ドメインモデル設計書](./domain-model.md) - 集約、属性、不変条件の詳細
- [各モジュール設計書](./modules/) - モジュール別の詳細設計

