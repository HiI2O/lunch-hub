# 認証機能 ユビキタス言語

## 認証・認可に関する用語

### ユーザーライフサイクル

#### 招待 (Invitation)
管理者が新しいユーザーをシステムに招待する行為。招待されたユーザーには招待メールが送信され、アカウントをアクティベートするための招待トークンが発行される。

#### 招待トークン (Invitation Token)
ユーザー招待時に生成される一意の文字列。有効期限は48時間。このトークンを使用してアカウントをアクティベートする。

#### アクティベーション (Activation)
招待されたユーザーが初回パスワードを設定し、アカウントを有効化する行為。アクティベーション完了後、ユーザーはログイン可能になる。

#### 招待済みユーザー (Invited User)
招待メールが送信されたが、まだアクティベーションが完了していないユーザー。

#### アクティブユーザー (Active User)
アクティベーションが完了し、システムにログイン可能なユーザー。

#### 無効化されたユーザー (Deactivated User)
管理者によってアクセスが無効化されたユーザー。ログインできない。

### 認証

#### 認証 (Authentication)
ユーザーが自分が誰であるかを証明するプロセス。メールアドレスとパスワードを使用する。

#### 認証情報 (Credentials)
ユーザーを認証するための情報。メールアドレスとパスワードの組み合わせ。

#### パスワードハッシュ (Password Hash)
パスワードをbcryptアルゴリズムで暗号化したもの。平文のパスワードは保存しない。

#### ログイン (Login)
認証情報を使用してシステムにアクセスする行為。成功するとセッションが確立される。

#### ログアウト (Logout)
確立されたセッションを終了する行為。アクセストークンとリフレッシュトークンが無効化される。

### セッション管理

#### セッション (Session)
ログイン後のユーザーの認証状態を表す。アクセストークンとリフレッシュトークンで管理される。

#### アクセストークン (Access Token)
APIリクエストの認証に使用される短期間有効なトークン(JWT)。有効期限は15分。

#### リフレッシュトークン (Refresh Token)
アクセストークンを更新するための長期間有効なトークン。有効期限は7日。

#### トークン更新 (Token Refresh)
期限切れのアクセストークンをリフレッシュトークンを使用して新しいアクセストークンに更新する行為。

#### セッション無効化 (Session Revocation)
セッションを強制的に終了させる行為。パスワード変更時や管理者による強制ログアウト時に実行される。

### パスワード管理

#### パスワードポリシー (Password Policy)
パスワードの強度を保証するためのルール。最低8文字、英数字と記号を含む。

#### パスワード変更 (Password Change)
ログイン後、現在のパスワードを入力して新しいパスワードに変更する行為。

#### パスワードリセット (Password Reset)
パスワードを忘れた場合に、メールアドレスを使用してパスワードを再設定する行為。

#### リセットトークン (Reset Token)
パスワードリセット時に生成される一意の文字列。有効期限は1時間。

### 認可

#### 認可 (Authorization)
認証されたユーザーが特定のリソースやアクションにアクセスする権限があるかを判断するプロセス。

#### 役割 (Role)
ユーザーに割り当てられる権限のセット。`ADMIN`(管理者)と`EMPLOYEE`(一般従業員)がある。

#### 管理者 (Admin)
`ADMIN`役割を持つユーザー。ユーザー招待、全機能へのアクセス権限を持つ。

#### 一般従業員 (Employee)
`EMPLOYEE`役割を持つユーザー。注文機能など、基本的な機能へのアクセス権限を持つ。

#### 権限 (Permission)
特定のアクションを実行する権利。役割に基づいて付与される。

### セキュリティ

#### レート制限 (Rate Limiting)
一定期間内のリクエスト回数を制限する仕組み。ログイン試行は5回/15分に制限される。

#### CSRF対策 (CSRF Protection)
クロスサイトリクエストフォージェリ攻撃を防ぐための対策。

#### HTTP-only Cookie
JavaScriptからアクセスできないCookie。XSS攻撃からトークンを保護する。

### 監査

#### 認証ログ (Authentication Log)
ログイン試行(成功・失敗)、パスワード変更、招待などの認証関連イベントの記録。

#### ログイン試行 (Login Attempt)
ユーザーがログインを試みた記録。成功・失敗の両方を記録する。

## 用語の関係性

```
招待 → 招待トークン発行 → アクティベーション → アクティブユーザー → ログイン → セッション確立
                                                                    ↓
                                                              アクセストークン
                                                              リフレッシュトークン
```

## 既存のLunch Hub用語との関連

- **ユーザー (User)**: 既存のドメインモデルの`User`集約に認証情報を追加
- **従業員 (Employee)**: `EMPLOYEE`役割を持つユーザーと対応
- **管理者 (Admin)**: `ADMIN`役割を持つユーザーと対応
